<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Environments | Miguel Agenjo</title>
    <link rel="stylesheet" href="project.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;500;800&display=swap" rel="stylesheet">
</head>
<body>

    <nav class="project-nav">
        <a href="index.html#work" class="back-link">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></svg>
            Back to Work
        </a>
        <a href="index.html" class="logo">
            <img src="docs/logo M.png" alt="Logo" class="logo-img">
            <span>MIGUEL AGENJO<span class="accent-dot">.</span></span>
        </a>
    </nav>

    <div class="project-hero">
        <img src="docs/miguel-agenjo-render-v3.jpg" alt="3D Environments">
        <div class="project-hero-overlay">
            <h1>3D Environments<span>.</span></h1>
            <p class="project-tagline">Building immersive worlds and cinematic landscapes</p>
        </div>
    </div>

    <div class="project-content">
        <div class="project-meta">
            <div class="meta-item">
                <span class="meta-label">Category</span>
                <span class="meta-value">Environment Art and set extension VFX.</span>
            </div>
            <div class="meta-item">
                <span class="meta-label">Software</span>
                <span class="meta-value">Maya, Houdini, SpeedTree, Substance, Arnold</span>
            </div>
            <div class="meta-item">
                <span class="meta-label">Role</span>
                <span class="meta-value">Layout, Scattering, Modeling, Look Development, Lighting</span>
            </div>
        </div>

        <div class="project-description">
            <p>A showcase of environment work created for film, personal projects, and artistic exploration. Each piece focuses on atmosphere, scale, and storytelling through lighting and composition. Combining technical and artistic skills to create complex worlds.</p>
        </div>

        <div class="project-gallery">
            <div class="gallery-item">
                <div class="gallery-images">
                    <img src="docs/miguel-agenjo-render-v3.jpg" alt="Environment render" class="active">
                    <img src="docs/miguel-agenjo-renderbkdwn3.jpg" alt="Environment render 2">
                </div>
                <div class="caption">
                    <strong>Project: Across the stars. Personal.</strong>
                    Full CG scene development.
                </div>
            </div>

            <div class="gallery-item">
                <div class="gallery-images">
                    <img src="docs/enviro_TheRoses.png" alt="The Roses environment" class="active">
                    <img src="docs/enviro2_TheRoses.png" alt="The Roses environment">
                </div>
                <div class="caption">
                    <strong>Project: The Roses. Searchlight Pictures.</strong>
                    Full CG replacement of the forest, terrain, and vegetation. Lead 3D artist for the project. 
                </div>
            </div>

            <div class="gallery-item">
                <div class="gallery-images">
                    <img src="docs/hernan_temple.png" alt="Temple environment" class="active">
                </div>
                <div class="caption">
                    <strong>Project: Hern√°n. Prime video.</strong>
                    Recreation of historical city of Tenochtitlan. Asset and prop work, layout, and lighting for multiple shots.
                </div>
            </div>

            <div class="gallery-item">
                <div class="gallery-images">
                    <img src="docs/memorial_enviro.png" alt="Memorial environment" class="active">
                </div>
                <div class="caption">
                    <strong>Project: Five Days at Memorial. Apple TV+.</strong>
                    Emmy Award-winning project for best environment. Responsible for vegetation creation, scatterings, look development assets, and lighting for a variety of set extension shots.
                </div>
            </div>

            <div class="gallery-item">
                <div class="gallery-images">
                    <img src="docs/halo_village_1.png" alt="Village environment 1" class="active">
                    <img src="docs/halo_village_2.png" alt="Village environment 2">
                </div>
                <div class="caption">
                    <strong>Project: Halo. SkyShowtime +.</strong>
                    Look development of environment assets and lighting for a variety of set extension and full CG shots.
                </div>
            </div>            
        </div>
    </div>

    <footer class="project-footer">
        <p>&copy; 2026 Miguel Agenjo. Designed with coffee and code.</p>
    </footer>

    <!-- Lightbox -->
    <div class="lightbox" id="lightbox">
        <button class="lightbox-close">&times;</button>
        <button class="lightbox-nav lb-prev">&#8249;</button>
        <button class="lightbox-nav lb-next">&#8250;</button>
        <img id="lightbox-img" src="" alt="Fullscreen view">
        <div class="lightbox-counter" id="lightbox-counter"></div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- Inline gallery navigation (buttons, dots, swipe) ---
            document.querySelectorAll('.gallery-item').forEach(item => {
                const container = item.querySelector('.gallery-images');
                if (!container) return;
                const imgs = container.querySelectorAll('img');
                if (imgs.length <= 1) return;

                let idx = 0;
                function show(i) {
                    imgs.forEach(im => im.classList.remove('active'));
                    dots.forEach(d => d.classList.remove('active'));
                    idx = (i + imgs.length) % imgs.length;
                    imgs[idx].classList.add('active');
                    dots[idx].classList.add('active');
                }

                // Nav buttons
                const prevBtn = document.createElement('button');
                prevBtn.className = 'gallery-nav prev';
                prevBtn.innerHTML = '&#8249;';
                prevBtn.addEventListener('click', e => { e.stopPropagation(); show(idx - 1); });
                const nextBtn = document.createElement('button');
                nextBtn.className = 'gallery-nav next';
                nextBtn.innerHTML = '&#8250;';
                nextBtn.addEventListener('click', e => { e.stopPropagation(); show(idx + 1); });
                container.appendChild(prevBtn);
                container.appendChild(nextBtn);

                // Dots
                const dotsContainer = document.createElement('div');
                dotsContainer.className = 'gallery-dots';
                const dots = [];
                imgs.forEach((_, i) => {
                    const dot = document.createElement('button');
                    dot.className = 'gallery-dot' + (i === 0 ? ' active' : '');
                    dot.addEventListener('click', e => { e.stopPropagation(); show(i); });
                    dotsContainer.appendChild(dot);
                    dots.push(dot);
                });
                container.after(dotsContainer);

                // Touch swipe
                let startX = 0;
                container.addEventListener('touchstart', e => { startX = e.changedTouches[0].screenX; }, { passive: true });
                container.addEventListener('touchend', e => {
                    const diff = startX - e.changedTouches[0].screenX;
                    if (Math.abs(diff) > 50) show(diff > 0 ? idx + 1 : idx - 1);
                });
            });

            // --- Lightbox ---
            const lightbox = document.getElementById('lightbox');
            const lightboxImg = document.getElementById('lightbox-img');
            const lightboxCounter = document.getElementById('lightbox-counter');
            const closeBtn = document.querySelector('.lightbox-close');
            const prev = document.querySelector('.lb-prev');
            const next = document.querySelector('.lb-next');
            let current = 0;
            let images = [];

            function goTo(index) {
                current = index;
                lightboxImg.src = images[current];
                lightboxCounter.textContent = `${current + 1} / ${images.length}`;
            }

            document.querySelectorAll('.gallery-item').forEach(item => {
                const imgs = item.querySelectorAll('.gallery-images img');
                imgs.forEach((img, i) => {
                    img.addEventListener('click', () => {
                        images = Array.from(imgs).map(im => im.src);
                        current = i;
                        goTo(current);
                        lightbox.classList.add('active');
                    });
                });
            });

            closeBtn.addEventListener('click', () => lightbox.classList.remove('active'));
            lightbox.addEventListener('click', e => {
                if (e.target === lightbox) lightbox.classList.remove('active');
            });
            document.addEventListener('keydown', e => {
                if (!lightbox.classList.contains('active')) return;
                if (e.key === 'Escape') lightbox.classList.remove('active');
                if (e.key === 'ArrowLeft') goTo((current - 1 + images.length) % images.length);
                if (e.key === 'ArrowRight') goTo((current + 1) % images.length);
            });

            prev.addEventListener('click', () => goTo((current - 1 + images.length) % images.length));
            next.addEventListener('click', () => goTo((current + 1) % images.length));

            // Lightbox touch swipe
            let lbStartX = 0;
            lightbox.addEventListener('touchstart', e => { lbStartX = e.changedTouches[0].screenX; }, { passive: true });
            lightbox.addEventListener('touchend', e => {
                const diff = lbStartX - e.changedTouches[0].screenX;
                if (Math.abs(diff) > 50) {
                    if (diff > 0) goTo((current + 1) % images.length);
                    else goTo((current - 1 + images.length) % images.length);
                }
            });
        });
    </script>

    <script>
        const nav = document.querySelector('.project-nav');
        window.addEventListener('scroll', () => {
            nav.classList.toggle('scrolled', window.scrollY > 40);
        });
    </script>

</body>
</html>
